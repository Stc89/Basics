A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE     1


MACRO ASSEMBLER A51 V8.01
OBJECT MODULE PLACED IN .\Objects\task_switch.OBJ
ASSEMBLER INVOKED BY: C:\Keil\C51\BIN\A51.EXE .\Objects\task_switch.src PR(.\Listings\task_switch.ls1) EP DEBUG

LOC  OBJ            LINE     SOURCE

                       1     ; .\Objects\task_switch.SRC generated from: task_switch.c
                       2     ; COMPILER INVOKED BY:
                       3     ;        C:\Keil\C51\BIN\C51.EXE task_switch.c BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\t
                             ask_switch.lst) SRC(.\Objects\task_switch.SRC)
                       4     
                       5     $nomod51 
                       6     
                       7     NAME    TASK_SWITCH
                       8     
  0093                 9     P0M1    DATA    093H
  0092                10     P1M0    DATA    092H
  0096                11     P2M0    DATA    096H
  0091                12     P1M1    DATA    091H
  0080                13     P0      DATA    080H
  00B2                14     P3M0    DATA    0B2H
  0095                15     P2M1    DATA    095H
  0090                16     P1      DATA    090H
  00B4                17     P4M0    DATA    0B4H
  00B1                18     P3M1    DATA    0B1H
  00A0                19     P2      DATA    0A0H
  00CA                20     P5M0    DATA    0CAH
  00B3                21     P4M1    DATA    0B3H
  00B0                22     P3      DATA    0B0H
  00AB                23     WKTCH   DATA    0ABH
  00D6                24     AC      BIT     0D0H.6
  00CC                25     P6M0    DATA    0CCH
  00C9                26     P5M1    DATA    0C9H
  00C0                27     P4      DATA    0C0H
  00E2                28     P7M0    DATA    0E2H
  00CB                29     P6M1    DATA    0CBH
  00C8                30     P5      DATA    0C8H
  00E8                31     P6      DATA    0E8H
  00E1                32     P7M1    DATA    0E1H
  00AF                33     EA      BIT     0A8H.7
  00F8                34     P7      DATA    0F8H
  00AA                35     WKTCL   DATA    0AAH
  00CE                36     SPCTL   DATA    0CEH
  00A2                37     P_SW1   DATA    0A2H
  00BA                38     P_SW2   DATA    0BAH
  00E5                39     DPH1    DATA    0E5H
  00AD                40     EADC    BIT     0A8H.5
  00A8                41     IE      DATA    0A8H
  00C5                42     IAP_CMD DATA    0C5H
  00E4                43     DPL1    DATA    0E4H
  00BD                44     ADC_RES DATA    0BDH
  00B6                45     IP2H    DATA    0B6H
  00EE                46     IP3H    DATA    0EEH
  00AE                47     TA      DATA    0AEH
  008F                48     INTCLKO DATA    08FH
  00AC                49     ES      BIT     0A8H.4
  00BD                50     PADC    BIT     0B8H.5
  00B8                51     IP      DATA    0B8H
  00DE                52     ADCCFG  DATA    0DEH
  0098                53     RI      BIT     098H.0
  00D7                54     CY      BIT     0D0H.7
  0099                55     TI      BIT     098H.1
  00C3                56     IAP_ADDRH       DATA    0C3H
  00BC                57     PS      BIT     0B8H.4
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE     2

  0081                58     SP      DATA    081H
  00C4                59     IAP_ADDRL       DATA    0C4H
  00D2                60     OV      BIT     0D0H.2
  00BF                61     PPCA    BIT     0B8H.7
  009E                62     LIRTRIM DATA    09EH
  00E6                63     CMPCR1  DATA    0E6H
  00E7                64     CMPCR2  DATA    0E7H
  00AE                65     ELVD    BIT     0A8H.6
  0080                66     P00     BIT     080H.0
  00BC                67     ADC_CONTR       DATA    0BCH
  0099                68     SBUF    DATA    099H
  0090                69     P10     BIT     090H.0
  0087                70     PCON    DATA    087H
  0081                71     P01     BIT     080H.1
  00A0                72     P20     BIT     0A0H.0
  0091                73     P11     BIT     090H.1
  0082                74     P02     BIT     080H.2
  00F5                75     IAP_TPS DATA    0F5H
  00B0                76     P30     BIT     0B0H.0
  00A1                77     P21     BIT     0A0H.1
  0092                78     P12     BIT     090H.2
  0083                79     P03     BIT     080H.3
  00C0                80     P40     BIT     0C0H.0
  00B1                81     P31     BIT     0B0H.1
  00A2                82     P22     BIT     0A0H.2
  0098                83     SCON    DATA    098H
  0093                84     P13     BIT     090H.3
  0084                85     P04     BIT     080H.4
  00C8                86     P50     BIT     0C8H.0
  00C1                87     P41     BIT     0C0H.1
  00B2                88     P32     BIT     0B0H.2
  00A3                89     P23     BIT     0A0H.3
  0094                90     P14     BIT     090H.4
  0089                91     TMOD    DATA    089H
  0088                92     TCON    DATA    088H
  0085                93     P05     BIT     080H.5
  00C9                94     P51     BIT     0C8H.1
  00C2                95     P42     BIT     0C0H.2
  00B3                96     P33     BIT     0B0H.3
  00A4                97     P24     BIT     0A0H.4
  0095                98     P15     BIT     090H.5
  0086                99     P06     BIT     080H.6
  00CA               100     P52     BIT     0C8H.2
  00C3               101     P43     BIT     0C0H.3
  00BE               102     PLVD    BIT     0B8H.6
  00B4               103     P34     BIT     0B0H.4
  00A5               104     P25     BIT     0A0H.5
  0096               105     P16     BIT     090H.6
  0087               106     P07     BIT     080H.7
  00CB               107     P53     BIT     0C8H.3
  00C4               108     P44     BIT     0C0H.4
  00B5               109     P35     BIT     0B0H.5
  00A6               110     P26     BIT     0A0H.6
  0097               111     P17     BIT     090H.7
  00CC               112     P54     BIT     0C8H.4
  00C5               113     P45     BIT     0C0H.5
  00B6               114     P36     BIT     0B0H.6
  00A7               115     P27     BIT     0A0H.7
  00C6               116     P46     BIT     0C0H.6
  00B7               117     P37     BIT     0B0H.7
  00C7               118     P47     BIT     0C0H.7
  0089               119     IE0     BIT     088H.1
  008B               120     IE1     BIT     088H.3
  00AF               121     IE2     DATA    0AFH
  00F0               122     B       DATA    0F0H
  008E               123     AUXR    DATA    08EH
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE     3

  00FC               124     USBADR  DATA    0FCH
  00C7               125     IAP_CONTR       DATA    0C7H
  00EC               126     USBDAT  DATA    0ECH
  00DC               127     USBCLK  DATA    0DCH
  00E0               128     ACC     DATA    0E0H
  00A9               129     ET0     BIT     0A8H.1
  00AB               130     ET1     BIT     0A8H.3
  008D               131     TF0     BIT     088H.5
  00FF               132     RSTCFG  DATA    0FFH
  00B5               133     IP2     DATA    0B5H
  008F               134     TF1     BIT     088H.7
  00F4               135     USBCON  DATA    0F4H
  00DF               136     IP3     DATA    0DFH
  009A               137     RB8     BIT     098H.2
  008C               138     TH0     DATA    08CH
  00A8               139     EX0     BIT     0A8H.0
  008D               140     TH1     DATA    08DH
  0088               141     IT0     BIT     088H.0
  00D6               142     T2H     DATA    0D6H
  00AA               143     EX1     BIT     0A8H.2
  009B               144     TB8     BIT     098H.3
  008A               145     IT1     BIT     088H.2
  00D4               146     T3H     DATA    0D4H
  00D0               147     P       BIT     0D0H.0
  00D2               148     T4H     DATA    0D2H
  009F               149     SM0     BIT     098H.7
  008A               150     TL0     DATA    08AH
  009E               151     SM1     BIT     098H.6
  008B               152     TL1     DATA    08BH
  00D7               153     T2L     DATA    0D7H
  009D               154     SM2     BIT     098H.5
  00D5               155     T3L     DATA    0D5H
  00D3               156     T4L     DATA    0D3H
  00B9               157     PT0     BIT     0B8H.1
  00D3               158     RS0     BIT     0D0H.3
  00BB               159     PT1     BIT     0B8H.3
  00D4               160     RS1     BIT     0D0H.4
  00C2               161     IAP_DATA        DATA    0C2H
  008C               162     TR0     BIT     088H.4
  008E               163     TR1     BIT     088H.6
  00C1               164     WDT_CONTR       DATA    0C1H
  00B8               165     PX0     BIT     0B8H.0
  00BA               166     PX1     BIT     0B8H.2
  009F               167     IRTRIM  DATA    09FH
  0083               168     DPH     DATA    083H
  00D1               169     T4T3M   DATA    0D1H
  00BE               170     ADC_RESL        DATA    0BEH
  0082               171     DPL     DATA    082H
  00CD               172     SPSTAT  DATA    0CDH
  00B7               173     IPH     DATA    0B7H
  009B               174     S2BUF   DATA    09BH
  00AD               175     S3BUF   DATA    0ADH
  009C               176     REN     BIT     098H.4
  0085               177     S4BUF   DATA    085H
  009A               178     S2CON   DATA    09AH
  00E3               179     DPS     DATA    0E3H
  00AC               180     S3CON   DATA    0ACH
  0084               181     S4CON   DATA    084H
  00EF               182     AUXINTIF        DATA    0EFH
  00B9               183     SADEN   DATA    0B9H
  00A9               184     SADDR   DATA    0A9H
  00C6               185     IAP_TRIG        DATA    0C6H
  00D5               186     F0      BIT     0D0H.5
  009D               187     IRCBAND DATA    09DH
  00D0               188     PSW     DATA    0D0H
  00CF               189     SPDAT   DATA    0CFH
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE     4

  0094               190     P0M0    DATA    094H
                     191     ?PR?os_cpu_sr_save?TASK_SWITCH           SEGMENT CODE 
                     192     ?PR?_os_cpu_sr_restore?TASK_SWITCH       SEGMENT CODE 
                     193     ?PR?_os_tesk_stack_init?TASK_SWITCH      SEGMENT CODE 
                     194     ?DT?_os_tesk_stack_init?TASK_SWITCH      SEGMENT DATA OVERLAYABLE 
                     195     ?PR?_os_delay?TASK_SWITCH                SEGMENT CODE 
                     196     ?DT?_os_delay?TASK_SWITCH                SEGMENT DATA OVERLAYABLE 
                     197     ?PR?os_time_tick?TASK_SWITCH             SEGMENT CODE 
                     198     ?PR?timer0_isr?TASK_SWITCH               SEGMENT CODE 
                     199     ?DT?timer0_isr?TASK_SWITCH               SEGMENT DATA OVERLAYABLE 
                     200             EXTRN   DATA (os_task_running_id)
                     201             EXTRN   CODE (os_int_enter)
                     202             EXTRN   DATA (os_map_tab)
                     203             EXTRN   DATA (os_int_count)
                     204             EXTRN   CODE (os_int_exit)
                     205             EXTRN   DATA (os_task_rdy_tab)
                     206             EXTRN   BIT (os_running)
                     207             EXTRN   IDATA (os_tcb)
                     208             PUBLIC  timer0_isr
                     209             PUBLIC  os_time_tick
                     210             PUBLIC  _os_delay
                     211             PUBLIC  _os_tesk_stack_init
                     212             PUBLIC  _os_cpu_sr_restore
                     213             PUBLIC  os_cpu_sr_save
                     214     
----                 215             RSEG  ?DT?timer0_isr?TASK_SWITCH
0000                 216     ?timer0_isr?BYTE:
0000                 217          cpu_sr?547:   DS   1
                     218     
----                 219             RSEG  ?DT?_os_tesk_stack_init?TASK_SWITCH
0000                 220     ?_os_tesk_stack_init?BYTE:
0000                 221            r_sp?242:   DS   1
                     222     
----                 223             RSEG  ?DT?_os_delay?TASK_SWITCH
0000                 224     ?_os_delay?BYTE:
0000                 225           tisks?343:   DS   1
                     226     ; #include "task_switch.h"
                     227     ; #include "reg51.h"
                     228     ; #include "core.h"
                     229     ; 
                     230     ; 
                     231     ; /* ½øÈëÁÙ½ç¶Î */
                     232     ; char os_cpu_sr_save(void)
                     233     
----                 234             RSEG  ?PR?os_cpu_sr_save?TASK_SWITCH
0000                 235     os_cpu_sr_save:
                     236             USING   0
                     237                             ; SOURCE LINE # 7
                     238     ; {
                     239                             ; SOURCE LINE # 8
                     240     ;       __asm mov r7,IE         //µÃµ½ÖÐ¶Ï¿ØÖÆ¼Ä´æÆ÷Öµ
0000 AFA8            241              mov r7,IE               
                     242     ;       __asm mov IE,#0
0002 75A800          243              mov IE,#0
                     244     ;       __asm ret                       //·µ»ØÖµÊÇÔÚr7ÖÐ
0005 22              245              ret                     
                     246     ;       return 0;                       //·µ»ØÕâÌõÖ¸ÁîÊµ¼Ê²»»á±»Ö´ÐÐµ½,µ«ÒòÎªÕâ¸öº¯ÊÈ·ÊµÒª·
                             µ»ØÖµ,ËùÒÔÐ´Ò»ÏÂ(²»È»»áÓÐ¾¯¸æ)
                     247                             ; SOURCE LINE # 12
0006 7F00            248             MOV     R7,#00H
                     249     ; }
                     250                             ; SOURCE LINE # 13
0008                 251     ?C0001:
0008 22              252             RET     
                     253     ; END OF os_cpu_sr_save
                     254     
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE     5

                     255     ; 
                     256     ; 
                     257     ; /* ÍË³öÁÙ½ç¶Î */
                     258     ; void os_cpu_sr_restore(char cpu_sr)
                     259     
----                 260             RSEG  ?PR?_os_cpu_sr_restore?TASK_SWITCH
0000                 261     _os_cpu_sr_restore:
                     262             USING   0
                     263                             ; SOURCE LINE # 17
                     264     ;---- Variable 'cpu_sr?140' assigned to Register 'R7' ----
                     265     ; {
                     266                             ; SOURCE LINE # 18
                     267     ;       cpu_sr = cpu_sr;        //µÚÒ»¸ö²ÎÊ(charÀàÐÍ)ÊÇ´æÔÚr7ÀïÃæµÄ,
                     268                             ; SOURCE LINE # 19
                     269     ;       __asm mov IE,r7         //»Ö¸´ÖÐ¶Ï¿ØÖÆ¼Ä´æÆ÷Öµ
0000 8FA8            270              mov IE,r7               
                     271     ;       __asm ret                       //Ò²¿ÉÒÔÃ»ÓÐ(º¯Ê»áÓÐret)
0002 22              272              ret                     
                     273     ; }
                     274                             ; SOURCE LINE # 22
0003 22              275             RET     
                     276     ; END OF _os_cpu_sr_restore
                     277     
                     278     ; 
                     279     ; 
                     280     ; 
                     281     ; /* ÈÎÎñ¶ÑÕ»³õÊ¼»¯ */
                     282     ; unsigned char os_tesk_stack_init(unsigned char stack_point)
                     283     
----                 284             RSEG  ?PR?_os_tesk_stack_init?TASK_SWITCH
0000                 285     _os_tesk_stack_init:
                     286             USING   0
                     287                             ; SOURCE LINE # 27
                     288     ;---- Variable 'stack_point?241' assigned to Register 'R7' ----
                     289     ; {
                     290                             ; SOURCE LINE # 28
                     291     ;       unsigned char r_sp = SP;
                     292                             ; SOURCE LINE # 29
0000 858100   F      293             MOV     r_sp?242,SP
                     294     ;       SP = stack_point;
                     295                             ; SOURCE LINE # 30
0003 8F81            296             MOV     SP,R7
                     297     ;       __asm PUSH ACC                          //¼Ä´æÆ÷ÈëÕ»(ÔÚ´ËÖ®Ç°²»ÄÜÓÐÈÎºÎÔËËã²Ù×÷,²»È
                             »»á¸Ä±ä¼Ä´æÆ÷Öµ)
0005 C0E0            298              PUSH ACC                                
                     299     ;       __asm PUSH B
0007 C0F0            300              PUSH B
                     301     ;       __asm PUSH DPH
0009 C083            302              PUSH DPH
                     303     ;       __asm PUSH DPL
000B C082            304              PUSH DPL
                     305     ;       __asm PUSH PSW
000D C0D0            306              PUSH PSW
                     307     ;       __asm PUSH 0
000F C000            308              PUSH 0
                     309     ;       __asm PUSH 1
0011 C001            310              PUSH 1
                     311     ;       __asm PUSH 2
0013 C002            312              PUSH 2
                     313     ;       __asm PUSH 3
0015 C003            314              PUSH 3
                     315     ;       __asm PUSH 4
0017 C004            316              PUSH 4
                     317     ;       __asm PUSH 5
0019 C005            318              PUSH 5
                     319     ;       __asm PUSH 6
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE     6

001B C006            320              PUSH 6
                     321     ;       __asm PUSH 7
001D C007            322              PUSH 7
                     323     ;       
                     324     ;       stack_point = SP;
                     325                             ; SOURCE LINE # 45
001F AF81            326             MOV     R7,SP
                     327     ;       SP = r_sp;
                     328                             ; SOURCE LINE # 46
0021 850081   F      329             MOV     SP,r_sp?242
                     330     ;       
                     331     ;       return stack_point;
                     332                             ; SOURCE LINE # 48
                     333     ; }
                     334                             ; SOURCE LINE # 49
0024                 335     ?C0003:
0024 22              336             RET     
                     337     ; END OF _os_tesk_stack_init
                     338     
                     339     ; 
                     340     ; 
                     341     ; 
                     342     ; 
                     343     ; 
                     344     ; 
                     345     ; 
                     346     ; /*ÒòÎªÃ»ÓÐ¶ÔPCÖ±½Ó²Ù×÷µÄÖ¸Áî,µ«ÖÐ¶Ï¹³ÌºÍ¹³Ìµ÷ÓÃ¿ÉÒÔÊ¹PCÈëÕ»,
                     347     ; ÖÐ¶Ï·µ»Ø,¹³Ì·µ»Ø¿ÉÒÔ,Ê¹PC³öÕ»,¿ÉÒÔ¼ä½ÓµÄÀûÓÃ´Ë·½·¨¶ÔPC²Ù×÷*/
                     348     ; 
                     349     ; /* ÏµÍ³ÑÓÊ± */
                     350     ; void os_delay(unsigned char tisks)
                     351     
----                 352             RSEG  ?PR?_os_delay?TASK_SWITCH
0000                 353     _os_delay:
                     354             USING   0
                     355                             ; SOURCE LINE # 61
0000 8F00     F      356             MOV     tisks?343,R7
                     357     ; {
                     358                             ; SOURCE LINE # 62
                     359     ;       unsigned char i;
                     360     ; //    char cpu_sr;
                     361     ;       
                     362     ;       if(tisks > 0)
                     363                             ; SOURCE LINE # 66
0002 E500     F      364             MOV     A,tisks?343
0004 D3              365             SETB    C
0005 9400            366             SUBB    A,#00H
0007 5003            367             JNC     $ + 5H
0009 020000   F      368             LJMP    ?C0010
                     369     ;       {       
                     370                             ; SOURCE LINE # 67
                     371     ;               //os_enter_critical();          
                     372     ;               EA = 0;                                         //Ö±½Ó²Ù×÷,¶ø²»ÓÃÁÙ½ç¶ÎµÄ·½
                             ·¨Ö÷ÒªÊÇÎªÁËÈÎÎñÇÐ»»¸ü¿ì
                     373                             ; SOURCE LINE # 69
000C C2AF            374             CLR     EA
                     375     ;               __asm PUSH ACC                          //¼Ä´æÆ÷ÈëÕ»(ÔÚ´ËÖ®Ç°²»ÄÜÓÐÈÎºÎÔËËã
                             ²Ù×÷,²»È»»á¸Ä±ä¼Ä´æÆ÷Öµ)
000E C0E0            376              PUSH ACC                                
                     377     ;               __asm PUSH B
0010 C0F0            378              PUSH B
                     379     ;               __asm PUSH DPH
0012 C083            380              PUSH DPH
                     381     ;               __asm PUSH DPL
0014 C082            382              PUSH DPL
                     383     ;               __asm PUSH PSW
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE     7

0016 C0D0            384              PUSH PSW
                     385     ;               __asm PUSH 0
0018 C000            386              PUSH 0
                     387     ;               __asm PUSH 1
001A C001            388              PUSH 1
                     389     ;               __asm PUSH 2
001C C002            390              PUSH 2
                     391     ;               __asm PUSH 3
001E C003            392              PUSH 3
                     393     ;               __asm PUSH 4
0020 C004            394              PUSH 4
                     395     ;               __asm PUSH 5
0022 C005            396              PUSH 5
                     397     ;               __asm PUSH 6
0024 C006            398              PUSH 6
                     399     ;               __asm PUSH 7
0026 C007            400              PUSH 7
                     401     ;               os_tcb[os_task_running_id].os_task_stcak_top = SP;
                     402                             ; SOURCE LINE # 83
0028 AF00     F      403             MOV     R7,os_task_running_id
002A EF              404             MOV     A,R7
002B 25E0            405             ADD     A,ACC
002D 25E0            406             ADD     A,ACC
002F 2400     F      407             ADD     A,#LOW (os_tcb+01H)
0031 F8              408             MOV     R0,A
0032 A681            409             MOV     @R0,SP
                     410     ;               
                     411     ; 
                     412     ;               os_tcb[os_task_running_id].os_tsak_wait_tick = tisks;   //ÑÓÊ±Ê±¼ä
                     413                             ; SOURCE LINE # 86
0034 AF00     F      414             MOV     R7,os_task_running_id
0036 EF              415             MOV     A,R7
0037 25E0            416             ADD     A,ACC
0039 25E0            417             ADD     A,ACC
003B 2400     F      418             ADD     A,#LOW (os_tcb)
003D F8              419             MOV     R0,A
003E A600     F      420             MOV     @R0,tisks?343
                     421     ;               os_tcb[os_task_running_id].suspend = 1;                                 //Ò
                             òÎªÓÐÑÓÊ±,ËùÒÔÏÈ¹ÒÆð±¾ÈÎÎñ
                     422                             ; SOURCE LINE # 87
0040 AF00     F      423             MOV     R7,os_task_running_id
0042 EF              424             MOV     A,R7
0043 25E0            425             ADD     A,ACC
0045 25E0            426             ADD     A,ACC
0047 2400     F      427             ADD     A,#LOW (os_tcb+03H)
0049 F8              428             MOV     R0,A
004A 7601            429             MOV     @R0,#01H
                     430     ;               for(i=0; i<MAX_TASK; i++)                                                  
                                          //ÕÒµ½ÒÑ¾­¾ÍÐ÷,Î´±»¹ÒÆð,ÇÒÓÅÏÈ¼¶×î¸ßµÄÈÎÎñ
                     431                             ; SOURCE LINE # 88
                     432     ;---- Variable 'i?344' assigned to Register 'R7' ----
004C E4              433             CLR     A
004D FF              434             MOV     R7,A
004E                 435     ?C0005:
                     436     ;               {
                     437                             ; SOURCE LINE # 89
                     438     ;                       if(os_task_rdy_tab & os_map_tab[i])
                     439                             ; SOURCE LINE # 90
004E 7400     F      440             MOV     A,#LOW (os_map_tab)
0050 2F              441             ADD     A,R7
0051 F8              442             MOV     R0,A
0052 E6              443             MOV     A,@R0
0053 5500     F      444             ANL     A,os_task_rdy_tab
0055 600B            445             JZ      ?C0007
                     446     ;                       {
                     447                             ; SOURCE LINE # 91
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE     8

                     448     ;                               if(0 == os_tcb[i].suspend)
                     449                             ; SOURCE LINE # 92
0057 EF              450             MOV     A,R7
0058 25E0            451             ADD     A,ACC
005A 25E0            452             ADD     A,ACC
005C 2400     F      453             ADD     A,#LOW (os_tcb+03H)
005E F8              454             MOV     R0,A
005F E6              455             MOV     A,@R0
0060 6004            456             JZ      ?C0006
                     457     ;                               {
                     458                             ; SOURCE LINE # 93
                     459     ;                                       break;
                     460                             ; SOURCE LINE # 94
                     461     ;                               }
                     462                             ; SOURCE LINE # 95
0062                 463     ?C0009:
                     464     ;                       }
                     465                             ; SOURCE LINE # 96
                     466     ;               }
                     467                             ; SOURCE LINE # 97
0062                 468     ?C0007:
0062 0F              469             INC     R7
0063 BF03E8          470             CJNE    R7,#03H,?C0005
0066                 471     ?C0006:
                     472     ;               os_task_running_id = i;                                                    
                                  //¿ÉÖ´ÐÐµÄ×î¸ßÓÅÏÈ¼¶ÈÎÎñ
                     473                             ; SOURCE LINE # 98
0066 8F00     F      474             MOV     os_task_running_id,R7
                     475     ; 
                     476     ;               SP = os_tcb[os_task_running_id].os_task_stcak_top;      //×î¸ßÓÅÏÈ¼¶ÈÎÎñµÄÕ
                             »¶¥
                     477                             ; SOURCE LINE # 100
0068 AF00     F      478             MOV     R7,os_task_running_id
006A EF              479             MOV     A,R7
006B 25E0            480             ADD     A,ACC
006D 25E0            481             ADD     A,ACC
006F 2400     F      482             ADD     A,#LOW (os_tcb+01H)
0071 F8              483             MOV     R0,A
0072 E6              484             MOV     A,@R0
0073 F581            485             MOV     SP,A
                     486     ;               __asm POP 7
0075 D007            487              POP 7
                     488     ;               __asm POP 6
0077 D006            489              POP 6
                     490     ;               __asm POP 5
0079 D005            491              POP 5
                     492     ;               __asm POP 4
007B D004            493              POP 4
                     494     ;               __asm POP 3
007D D003            495              POP 3
                     496     ;               __asm POP 2
007F D002            497              POP 2
                     498     ;               __asm POP 1
0081 D001            499              POP 1
                     500     ;               __asm POP 0
0083 D000            501              POP 0
                     502     ;               __asm POP PSW
0085 D0D0            503              POP PSW
                     504     ;               __asm POP DPL
0087 D082            505              POP DPL
                     506     ;               __asm POP DPH
0089 D083            507              POP DPH
                     508     ;               __asm POP B
008B D0F0            509              POP B
                     510     ;               __asm POP ACC
008D D0E0            511              POP ACC
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE     9

                     512     ;               EA = 1;
                     513                             ; SOURCE LINE # 114
008F D2AF            514             SETB    EA
                     515     ;               //os_exit_critical();
                     516     ;               //__asm RET     //ºóÃæÊÇº¯Ê·µ»Ø,¼´ ret
                     517     ;               //__asm reti
                     518     ;       }
                     519                             ; SOURCE LINE # 118
                     520     ; }
                     521                             ; SOURCE LINE # 119
0091                 522     ?C0010:
0091 22              523             RET     
                     524     ; END OF _os_delay
                     525     
                     526     ; 
                     527     ; /* ÏµÍ³ÐÄÌø¸üÐÂ */
                     528     ; void os_time_tick(void)
                     529     
----                 530             RSEG  ?PR?os_time_tick?TASK_SWITCH
0000                 531     os_time_tick:
                     532             USING   0
                     533                             ; SOURCE LINE # 122
                     534     ; {
                     535                             ; SOURCE LINE # 123
                     536     ;       unsigned char i;
                     537     ;       
                     538     ;       for(i=0; i<MAX_TASK; i++)
                     539                             ; SOURCE LINE # 126
                     540     ;---- Variable 'i?445' assigned to Register 'R7' ----
0000 E4              541             CLR     A
0001 FF              542             MOV     R7,A
0002                 543     ?C0011:
                     544     ;       {
                     545                             ; SOURCE LINE # 127
                     546     ;               if(os_tcb[i].os_tsak_wait_tick)
                     547                             ; SOURCE LINE # 128
0002 EF              548             MOV     A,R7
0003 25E0            549             ADD     A,ACC
0005 25E0            550             ADD     A,ACC
0007 2400     F      551             ADD     A,#LOW (os_tcb)
0009 F8              552             MOV     R0,A
000A E6              553             MOV     A,@R0
000B 601E            554             JZ      ?C0013
                     555     ;               {
                     556                             ; SOURCE LINE # 129
                     557     ;                       os_tcb[i].os_tsak_wait_tick--;
                     558                             ; SOURCE LINE # 130
000D EF              559             MOV     A,R7
000E 25E0            560             ADD     A,ACC
0010 25E0            561             ADD     A,ACC
0012 2400     F      562             ADD     A,#LOW (os_tcb)
0014 F8              563             MOV     R0,A
0015 16              564             DEC     @R0
                     565     ;                       if(0 == os_tcb[i].os_tsak_wait_tick)    //Ã»ÓÐµÈ´Ê±¼ä,ÔòÈÎÎñ½øÈë¾ÍÐ
                             ÷×´Ì¬
                     566                             ; SOURCE LINE # 131
0016 EF              567             MOV     A,R7
0017 25E0            568             ADD     A,ACC
0019 25E0            569             ADD     A,ACC
001B 2400     F      570             ADD     A,#LOW (os_tcb)
001D F8              571             MOV     R0,A
001E E6              572             MOV     A,@R0
001F 700A            573             JNZ     ?C0013
                     574     ;                       {
                     575                             ; SOURCE LINE # 132
                     576     ;                               os_tcb[i].suspend = 0;          //
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE    10

                     577                             ; SOURCE LINE # 133
0021 EF              578             MOV     A,R7
0022 25E0            579             ADD     A,ACC
0024 25E0            580             ADD     A,ACC
0026 2400     F      581             ADD     A,#LOW (os_tcb+03H)
0028 F8              582             MOV     R0,A
0029 E4              583             CLR     A
002A F6              584             MOV     @R0,A
                     585     ;                       }
                     586                             ; SOURCE LINE # 134
                     587     ;               }
                     588                             ; SOURCE LINE # 135
                     589     ;       }
                     590                             ; SOURCE LINE # 136
002B                 591     ?C0013:
002B 0F              592             INC     R7
002C BF03D3          593             CJNE    R7,#03H,?C0011
                     594     ;       
                     595     ; }
                     596                             ; SOURCE LINE # 138
002F                 597     ?C0016:
002F 22              598             RET     
                     599     ; END OF os_time_tick
                     600     
----                 601     CSEG    AT      0000BH
000B 020000   F      602             LJMP    timer0_isr
                     603     
                     604     ; 
                     605     ; 
                     606     ; /* ÈÎÎñÇÐ»»ÐÄÌø */
                     607     ; void timer0_isr(void) interrupt 1     //using 0 Ä¬ÈÏÓÃ,ËùÓÐµÄ¼Ä´æÆ÷»á×Ô¶¯ÈëÕ», 
                     608     
----                 609             RSEG  ?PR?timer0_isr?TASK_SWITCH
                     610             USING   0
0000                 611     timer0_isr:
0000 C0E0            612             PUSH    ACC
0002 C0F0            613             PUSH    B
0004 C083            614             PUSH    DPH
0006 C082            615             PUSH    DPL
0008 C0D0            616             PUSH    PSW
000A 75D000          617             MOV     PSW,#00H
000D C000            618             PUSH    AR0
000F C001            619             PUSH    AR1
0011 C002            620             PUSH    AR2
0013 C003            621             PUSH    AR3
0015 C004            622             PUSH    AR4
0017 C005            623             PUSH    AR5
0019 C006            624             PUSH    AR6
001B C007            625             PUSH    AR7
                     626             USING   0
                     627                             ; SOURCE LINE # 142
                     628     ; {                                                     //  ÓÃusing 1 2 3 ÔòÐèÒªÊÖ¶¯¶Ôr0-r7
                             ÈëÕ»,³öÕ»(Çë²é¿´¼Ä´æÆ÷×éÑ¡Ôñ(¿´ÈÎÒâÒ»±¾½²51µÄÊé))
                     629     ;       unsigned char i;
                     630     ;       char cpu_sr;
                     631     ;       
                     632     ;       if(os_true == os_running)
                     633                             ; SOURCE LINE # 147
001D 30005B   F      634             JNB     os_running,?C0025
                     635     ;       {
                     636                             ; SOURCE LINE # 148
                     637     ;               os_enter_critical();
                     638                             ; SOURCE LINE # 149
0020 120000   F      639             LCALL   os_cpu_sr_save
0023 8F00     F      640             MOV     cpu_sr?547,R7
                     641     ;               
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE    11

                     642     ;       /*      ¼Ä´æÆ÷ÈëÕ»(×¢ÊÍµÄ²¿·ÖÊÇÔÚ½øÈëÖÐ¶Ïº¯ÊÇ°ÒÑ¾­Ñ¹ÈëÕ»ÖÐ
                     643     ;               (º¯Êµ÷ÓÃ»áÈÃPCÑ¹Õ»,ÖÐ¶Ïº¯Ê²»µ«»áÈÃPCÑ¹Õ»,»¹»á¶ÔÏÂÃæÎå¸ö¼Ä´æÆ÷Ñ¹Õ»)
                     644     ;               ,¾ÍÊÇÎÒÐ´µÄÕâ¸öË³Ðò)    */
                     645     ;       //      __asm PUSH ACC                  
                     646     ;       //      __asm PUSH B
                     647     ;       //      __asm PUSH DPH
                     648     ;       //      __asm PUSH DPL
                     649     ;       //      __asm PUSH PSW
                     650     ; //            __asm PUSH 0
                     651     ; //            __asm PUSH 1
                     652     ; //            __asm PUSH 2
                     653     ; //            __asm PUSH 3
                     654     ; //            __asm PUSH 4
                     655     ; //            __asm PUSH 5
                     656     ; //            __asm PUSH 6
                     657     ; //            __asm PUSH 7
                     658     ;               os_int_enter();
                     659                             ; SOURCE LINE # 167
0025 120000   F      660             LCALL   os_int_enter
                     661     ;               
                     662     ;               os_time_tick();
                     663                             ; SOURCE LINE # 169
0028 120000   F      664             LCALL   os_time_tick
                     665     ;               if(1 == os_int_count)           //µ±È»,51µ¥Æ¬»ú×î¶àÖ»ÄÜÓÐÒ»´ÎÖÐ¶ÏÇ¶Ì×,os_in
                             t_count×î´óÎª2(+±¾´Î)
                     666                             ; SOURCE LINE # 170
002B E500     F      667             MOV     A,os_int_count
002D 6401            668             XRL     A,#01H
002F 703A            669             JNZ     ?C0018
                     670     ;               {
                     671                             ; SOURCE LINE # 171
                     672     ;                       os_tcb[os_task_running_id].os_task_stcak_top = SP;      
                     673                             ; SOURCE LINE # 172
0031 AF00     F      674             MOV     R7,os_task_running_id
0033 EF              675             MOV     A,R7
0034 25E0            676             ADD     A,ACC
0036 25E0            677             ADD     A,ACC
0038 2400     F      678             ADD     A,#LOW (os_tcb+01H)
003A F8              679             MOV     R0,A
003B A681            680             MOV     @R0,SP
                     681     ;                       
                     682     ;                       for(i=0; i<MAX_TASK; i++)               //ÕÒµ½ÒÑ¾­¾ÍÐ÷,Î´±»¹ÒÆð,ÇÒÓ
                             ÅÏÈ¼¶×î¸ßµÄÈÎÎñ(ÈÎÎñµ÷¶ÈÆ÷)
                     683                             ; SOURCE LINE # 174
                     684     ;---- Variable 'i?546' assigned to Register 'R7' ----
003D E4              685             CLR     A
003E FF              686             MOV     R7,A
003F                 687     ?C0019:
                     688     ;                       {
                     689                             ; SOURCE LINE # 175
                     690     ;                               if(os_task_rdy_tab & os_map_tab[i])
                     691                             ; SOURCE LINE # 176
003F 7400     F      692             MOV     A,#LOW (os_map_tab)
0041 2F              693             ADD     A,R7
0042 F8              694             MOV     R0,A
0043 E6              695             MOV     A,@R0
0044 5500     F      696             ANL     A,os_task_rdy_tab
0046 600B            697             JZ      ?C0021
                     698     ;                               {
                     699                             ; SOURCE LINE # 177
                     700     ;                                       if(0 == os_tcb[i].suspend)
                     701                             ; SOURCE LINE # 178
0048 EF              702             MOV     A,R7
0049 25E0            703             ADD     A,ACC
004B 25E0            704             ADD     A,ACC
004D 2400     F      705             ADD     A,#LOW (os_tcb+03H)
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE    12

004F F8              706             MOV     R0,A
0050 E6              707             MOV     A,@R0
0051 6004            708             JZ      ?C0020
                     709     ;                                       {
                     710                             ; SOURCE LINE # 179
                     711     ;                                               break;
                     712                             ; SOURCE LINE # 180
                     713     ;                                       }
                     714                             ; SOURCE LINE # 181
0053                 715     ?C0023:
                     716     ;                               }
                     717                             ; SOURCE LINE # 182
                     718     ;                       }
                     719                             ; SOURCE LINE # 183
0053                 720     ?C0021:
0053 0F              721             INC     R7
0054 BF03E8          722             CJNE    R7,#03H,?C0019
0057                 723     ?C0020:
                     724     ;                       if(os_task_running_id != i)             //ÏÖÔÚÖ´ÐÐµÄÈÎÎñ¾ÍÊÇÓÅÏÈ¼¶×
                             î¸ßµÄ,ËùÒÔ²»ÐèÒªÈÎÎñÇÐ»»
                     725                             ; SOURCE LINE # 184
0057 E500     F      726             MOV     A,os_task_running_id
0059 6F              727             XRL     A,R7
005A 600F            728             JZ      ?C0018
                     729     ;                       {
                     730                             ; SOURCE LINE # 185
                     731     ;                               os_task_running_id = i;                 //¿ÉÖ´ÐÐµÄ×î¸ßÓÅÏÈ¼
                             ¶ÈÎÎñ
                     732                             ; SOURCE LINE # 186
005C 8F00     F      733             MOV     os_task_running_id,R7
                     734     ;                               SP = os_tcb[os_task_running_id].os_task_stcak_top;      //×
                             î¸ßÓÅÏÈ¼¶ÈÎÎñµÄÕ»¶¥
                     735                             ; SOURCE LINE # 187
005E AF00     F      736             MOV     R7,os_task_running_id
0060 EF              737             MOV     A,R7
0061 25E0            738             ADD     A,ACC
0063 25E0            739             ADD     A,ACC
0065 2400     F      740             ADD     A,#LOW (os_tcb+01H)
0067 F8              741             MOV     R0,A
0068 E6              742             MOV     A,@R0
0069 F581            743             MOV     SP,A
                     744     ;                       }
                     745                             ; SOURCE LINE # 188
                     746     ;               }
                     747                             ; SOURCE LINE # 189
006B                 748     ?C0018:
                     749     ;               
                     750     ;               TF0 = 0;                        //Çå³ÖÐ¶Ï±êÖ¾
                     751                             ; SOURCE LINE # 191
006B C28D            752             CLR     TF0
                     753     ;               TH0 = 0xee;                     //Ê±¼äÖØ×°ÔØ
                     754                             ; SOURCE LINE # 192
006D 758CEE          755             MOV     TH0,#0EEH
                     756     ;               TL0 = 0x00;
                     757                             ; SOURCE LINE # 193
0070 758A00          758             MOV     TL0,#00H
                     759     ;               os_int_exit();
                     760                             ; SOURCE LINE # 194
0073 120000   F      761             LCALL   os_int_exit
                     762     ;               
                     763     ;               
                     764     ; //            __asm POP 7
                     765     ; //            __asm POP 6
                     766     ; //            __asm POP 5
                     767     ; //            __asm POP 4
                     768     ; //            __asm POP 3
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE    13

                     769     ; //            __asm POP 2
                     770     ; //            __asm POP 1
                     771     ; //            __asm POP 0
                     772     ;               
                     773     ;               os_exit_critical();
                     774                             ; SOURCE LINE # 206
0076 AF00     F      775             MOV     R7,cpu_sr?547
0078 120000   F      776             LCALL   _os_cpu_sr_restore
                     777     ;               /*ºÍÇ°ÃæµÄµÀÀíÏàÍ¬(¼ÈÈ»Ñ¹Õ»ÁË,µ±È»Ò²Òª³öÕ»)(ËµÃ÷,ºóÃæÊÖ¶¯¼ÓµÄ__asm RETI,ÔòÏ
                             ÂÃæµÄÕâ¼¸ÌøPOPÊÇ±ØÐëÒªµÄ,
                     778     ;                       ÕâÊÇÎªÊ²Ã´ÄØ?    ¹þ¹þ,ÒòÎªÄ¬ÈÏÇé¿öÏÂ,RETIÖ¸ÁîÊÇÒªÔÚ,POPµÄºóÃæ,²»È»¾
                             Í²»ÄÜÖ´ÐÐPOP,Õâ¼¸¸ö¼Ä´æÆ÷Öµ¾Í»Ö¸´²»ÁË
                     779     ;                       ,×îÖØÒªµÄÊÇSPÒ²¾ÍÂÒÌ×ÁË ,,,,,,,)*/
                     780     ;       //      __asm POP PSW                   
                     781     ;       //      __asm POP DPL
                     782     ;       //      __asm POP DPH
                     783     ;       //      __asm POP B
                     784     ;       //      __asm POP ACC
                     785     ;               /*Ð´²»Ð´¶¼Ò»Ñù(Ð´ÁË,ÕâÌõÓï¾äÖ´ÐÐÍê»á½øÐÐÉÏÃæ¼Ä´æÆ÷ºÍPC³öÕ»,
                     786     ;               ²»Ð´µÄ»°,CÓïÑÔÐ´µÄÖÐ¶Ïº¯Ê,±àÒëÆ÷»ã±à¹ºó,»áÔÚºóÃæ¼ÓÒ»ÌõretiÖ¸Áî,ºÍÉÏÃæÖ´ÐÐÏà
                             Í¬µÄ¹¦ÄÜ)
                     787     ;               ¡¾Ð´µ½ÕâÀï,Í¬Ñ§ÎÒÍ»È»ÓÐÕâÃ´Ò»¸öÏë·¨,ÄÜ²»ÄÜÓÃret(reti¶ÔÖÐ¶Ï±êÖ¾Î»ÓÐÇåÁã×÷ÓÃ,
                             ÕâÀïÎÒÃÇÊÖ¶¯Çå³±êÖ¾Î»¾Í¿ÉÒÔÁË)
                     788     ;               ,º¯Ê·µ»ØÖ¸ÁîÀ´·µ»ØÖÐ¶Ïº¯Ê,µ±È»ÕâÐ©POPÖ®ÀàµÄÖ¸Áî¾ÍÐèÒªÊÕµ½Ð´ÁË,³ÌÐòÊÇÍæ³öÀ´µ
                             Ä,´ó¼Ò¿ÉÒÔ¾¡ÇéµÄ³¢ÊÔ¹þ^_^¡¿*/
                     789     ;       //      __asm RETI      
                     790     ;       //      __asm   ret   //ºÃÏñ²»¿ÉÒÔ,ÎªÊ²Ã´ÄØ?
                     791     ;       }
                     792                             ; SOURCE LINE # 221
                     793     ;       
                     794     ; }
                     795                             ; SOURCE LINE # 223
007B                 796     ?C0025:
007B D007            797             POP     AR7
007D D006            798             POP     AR6
007F D005            799             POP     AR5
0081 D004            800             POP     AR4
0083 D003            801             POP     AR3
0085 D002            802             POP     AR2
0087 D001            803             POP     AR1
0089 D000            804             POP     AR0
008B D0D0            805             POP     PSW
008D D082            806             POP     DPL
008F D083            807             POP     DPH
0091 D0F0            808             POP     B
0093 D0E0            809             POP     ACC
0095 32              810             RETI    
                     811     ; END OF timer0_isr
                     812     
                     813             END
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE    14

SYMBOL TABLE LISTING
------ ----- -------


N A M E                              T Y P E  V A L U E   ATTRIBUTES

?C0001. . . . . . . . . . . . . . .  C ADDR   0008H   R   SEG=?PR?OS_CPU_SR_SAVE?TASK_SWITCH
?C0003. . . . . . . . . . . . . . .  C ADDR   0024H   R   SEG=?PR?_OS_TESK_STACK_INIT?TASK_SWITCH
?C0005. . . . . . . . . . . . . . .  C ADDR   004EH   R   SEG=?PR?_OS_DELAY?TASK_SWITCH
?C0006. . . . . . . . . . . . . . .  C ADDR   0066H   R   SEG=?PR?_OS_DELAY?TASK_SWITCH
?C0007. . . . . . . . . . . . . . .  C ADDR   0062H   R   SEG=?PR?_OS_DELAY?TASK_SWITCH
?C0009. . . . . . . . . . . . . . .  C ADDR   0062H   R   SEG=?PR?_OS_DELAY?TASK_SWITCH
?C0010. . . . . . . . . . . . . . .  C ADDR   0091H   R   SEG=?PR?_OS_DELAY?TASK_SWITCH
?C0011. . . . . . . . . . . . . . .  C ADDR   0002H   R   SEG=?PR?OS_TIME_TICK?TASK_SWITCH
?C0013. . . . . . . . . . . . . . .  C ADDR   002BH   R   SEG=?PR?OS_TIME_TICK?TASK_SWITCH
?C0016. . . . . . . . . . . . . . .  C ADDR   002FH   R   SEG=?PR?OS_TIME_TICK?TASK_SWITCH
?C0018. . . . . . . . . . . . . . .  C ADDR   006BH   R   SEG=?PR?TIMER0_ISR?TASK_SWITCH
?C0019. . . . . . . . . . . . . . .  C ADDR   003FH   R   SEG=?PR?TIMER0_ISR?TASK_SWITCH
?C0020. . . . . . . . . . . . . . .  C ADDR   0057H   R   SEG=?PR?TIMER0_ISR?TASK_SWITCH
?C0021. . . . . . . . . . . . . . .  C ADDR   0053H   R   SEG=?PR?TIMER0_ISR?TASK_SWITCH
?C0023. . . . . . . . . . . . . . .  C ADDR   0053H   R   SEG=?PR?TIMER0_ISR?TASK_SWITCH
?C0025. . . . . . . . . . . . . . .  C ADDR   007BH   R   SEG=?PR?TIMER0_ISR?TASK_SWITCH
?DT?TIMER0_ISR?TASK_SWITCH. . . . .  D SEG    0001H       REL=UNIT
?DT?_OS_DELAY?TASK_SWITCH . . . . .  D SEG    0001H       REL=UNIT
?DT?_OS_TESK_STACK_INIT?TASK_SWITCH  D SEG    0001H       REL=UNIT
?PR?OS_CPU_SR_SAVE?TASK_SWITCH. . .  C SEG    0009H       REL=UNIT
?PR?OS_TIME_TICK?TASK_SWITCH. . . .  C SEG    0030H       REL=UNIT
?PR?TIMER0_ISR?TASK_SWITCH. . . . .  C SEG    0096H       REL=UNIT
?PR?_OS_CPU_SR_RESTORE?TASK_SWITCH.  C SEG    0004H       REL=UNIT
?PR?_OS_DELAY?TASK_SWITCH . . . . .  C SEG    0092H       REL=UNIT
?PR?_OS_TESK_STACK_INIT?TASK_SWITCH  C SEG    0025H       REL=UNIT
?TIMER0_ISR?BYTE. . . . . . . . . .  D ADDR   0000H   R   SEG=?DT?TIMER0_ISR?TASK_SWITCH
?_OS_DELAY?BYTE . . . . . . . . . .  D ADDR   0000H   R   SEG=?DT?_OS_DELAY?TASK_SWITCH
?_OS_TESK_STACK_INIT?BYTE . . . . .  D ADDR   0000H   R   SEG=?DT?_OS_TESK_STACK_INIT?TASK_SWITCH
AC. . . . . . . . . . . . . . . . .  B ADDR   00D0H.6 A   
ACC . . . . . . . . . . . . . . . .  D ADDR   00E0H   A   
ADCCFG. . . . . . . . . . . . . . .  D ADDR   00DEH   A   
ADC_CONTR . . . . . . . . . . . . .  D ADDR   00BCH   A   
ADC_RES . . . . . . . . . . . . . .  D ADDR   00BDH   A   
ADC_RESL. . . . . . . . . . . . . .  D ADDR   00BEH   A   
AR0 . . . . . . . . . . . . . . . .  D ADDR   0000H   A   
AR1 . . . . . . . . . . . . . . . .  D ADDR   0001H   A   
AR2 . . . . . . . . . . . . . . . .  D ADDR   0002H   A   
AR3 . . . . . . . . . . . . . . . .  D ADDR   0003H   A   
AR4 . . . . . . . . . . . . . . . .  D ADDR   0004H   A   
AR5 . . . . . . . . . . . . . . . .  D ADDR   0005H   A   
AR6 . . . . . . . . . . . . . . . .  D ADDR   0006H   A   
AR7 . . . . . . . . . . . . . . . .  D ADDR   0007H   A   
AUXINTIF. . . . . . . . . . . . . .  D ADDR   00EFH   A   
AUXR. . . . . . . . . . . . . . . .  D ADDR   008EH   A   
B . . . . . . . . . . . . . . . . .  D ADDR   00F0H   A   
CMPCR1. . . . . . . . . . . . . . .  D ADDR   00E6H   A   
CMPCR2. . . . . . . . . . . . . . .  D ADDR   00E7H   A   
CPU_SR?547. . . . . . . . . . . . .  D ADDR   0000H   R   SEG=?DT?TIMER0_ISR?TASK_SWITCH
CY. . . . . . . . . . . . . . . . .  B ADDR   00D0H.7 A   
DPH . . . . . . . . . . . . . . . .  D ADDR   0083H   A   
DPH1. . . . . . . . . . . . . . . .  D ADDR   00E5H   A   
DPL . . . . . . . . . . . . . . . .  D ADDR   0082H   A   
DPL1. . . . . . . . . . . . . . . .  D ADDR   00E4H   A   
DPS . . . . . . . . . . . . . . . .  D ADDR   00E3H   A   
EA. . . . . . . . . . . . . . . . .  B ADDR   00A8H.7 A   
EADC. . . . . . . . . . . . . . . .  B ADDR   00A8H.5 A   
ELVD. . . . . . . . . . . . . . . .  B ADDR   00A8H.6 A   
ES. . . . . . . . . . . . . . . . .  B ADDR   00A8H.4 A   
ET0 . . . . . . . . . . . . . . . .  B ADDR   00A8H.1 A   
ET1 . . . . . . . . . . . . . . . .  B ADDR   00A8H.3 A   
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE    15

EX0 . . . . . . . . . . . . . . . .  B ADDR   00A8H.0 A   
EX1 . . . . . . . . . . . . . . . .  B ADDR   00A8H.2 A   
F0. . . . . . . . . . . . . . . . .  B ADDR   00D0H.5 A   
IAP_ADDRH . . . . . . . . . . . . .  D ADDR   00C3H   A   
IAP_ADDRL . . . . . . . . . . . . .  D ADDR   00C4H   A   
IAP_CMD . . . . . . . . . . . . . .  D ADDR   00C5H   A   
IAP_CONTR . . . . . . . . . . . . .  D ADDR   00C7H   A   
IAP_DATA. . . . . . . . . . . . . .  D ADDR   00C2H   A   
IAP_TPS . . . . . . . . . . . . . .  D ADDR   00F5H   A   
IAP_TRIG. . . . . . . . . . . . . .  D ADDR   00C6H   A   
IE. . . . . . . . . . . . . . . . .  D ADDR   00A8H   A   
IE0 . . . . . . . . . . . . . . . .  B ADDR   0088H.1 A   
IE1 . . . . . . . . . . . . . . . .  B ADDR   0088H.3 A   
IE2 . . . . . . . . . . . . . . . .  D ADDR   00AFH   A   
INTCLKO . . . . . . . . . . . . . .  D ADDR   008FH   A   
IP. . . . . . . . . . . . . . . . .  D ADDR   00B8H   A   
IP2 . . . . . . . . . . . . . . . .  D ADDR   00B5H   A   
IP2H. . . . . . . . . . . . . . . .  D ADDR   00B6H   A   
IP3 . . . . . . . . . . . . . . . .  D ADDR   00DFH   A   
IP3H. . . . . . . . . . . . . . . .  D ADDR   00EEH   A   
IPH . . . . . . . . . . . . . . . .  D ADDR   00B7H   A   
IRCBAND . . . . . . . . . . . . . .  D ADDR   009DH   A   
IRTRIM. . . . . . . . . . . . . . .  D ADDR   009FH   A   
IT0 . . . . . . . . . . . . . . . .  B ADDR   0088H.0 A   
IT1 . . . . . . . . . . . . . . . .  B ADDR   0088H.2 A   
LIRTRIM . . . . . . . . . . . . . .  D ADDR   009EH   A   
OS_CPU_SR_SAVE. . . . . . . . . . .  C ADDR   0000H   R   SEG=?PR?OS_CPU_SR_SAVE?TASK_SWITCH
OS_INT_COUNT. . . . . . . . . . . .  D ADDR   -----       EXT
OS_INT_ENTER. . . . . . . . . . . .  C ADDR   -----       EXT
OS_INT_EXIT . . . . . . . . . . . .  C ADDR   -----       EXT
OS_MAP_TAB. . . . . . . . . . . . .  D ADDR   -----       EXT
OS_RUNNING. . . . . . . . . . . . .  B ADDR   -----       EXT
OS_TASK_RDY_TAB . . . . . . . . . .  D ADDR   -----       EXT
OS_TASK_RUNNING_ID. . . . . . . . .  D ADDR   -----       EXT
OS_TCB. . . . . . . . . . . . . . .  I ADDR   -----       EXT
OS_TIME_TICK. . . . . . . . . . . .  C ADDR   0000H   R   SEG=?PR?OS_TIME_TICK?TASK_SWITCH
OV. . . . . . . . . . . . . . . . .  B ADDR   00D0H.2 A   
P . . . . . . . . . . . . . . . . .  B ADDR   00D0H.0 A   
P0. . . . . . . . . . . . . . . . .  D ADDR   0080H   A   
P00 . . . . . . . . . . . . . . . .  B ADDR   0080H.0 A   
P01 . . . . . . . . . . . . . . . .  B ADDR   0080H.1 A   
P02 . . . . . . . . . . . . . . . .  B ADDR   0080H.2 A   
P03 . . . . . . . . . . . . . . . .  B ADDR   0080H.3 A   
P04 . . . . . . . . . . . . . . . .  B ADDR   0080H.4 A   
P05 . . . . . . . . . . . . . . . .  B ADDR   0080H.5 A   
P06 . . . . . . . . . . . . . . . .  B ADDR   0080H.6 A   
P07 . . . . . . . . . . . . . . . .  B ADDR   0080H.7 A   
P0M0. . . . . . . . . . . . . . . .  D ADDR   0094H   A   
P0M1. . . . . . . . . . . . . . . .  D ADDR   0093H   A   
P1. . . . . . . . . . . . . . . . .  D ADDR   0090H   A   
P10 . . . . . . . . . . . . . . . .  B ADDR   0090H.0 A   
P11 . . . . . . . . . . . . . . . .  B ADDR   0090H.1 A   
P12 . . . . . . . . . . . . . . . .  B ADDR   0090H.2 A   
P13 . . . . . . . . . . . . . . . .  B ADDR   0090H.3 A   
P14 . . . . . . . . . . . . . . . .  B ADDR   0090H.4 A   
P15 . . . . . . . . . . . . . . . .  B ADDR   0090H.5 A   
P16 . . . . . . . . . . . . . . . .  B ADDR   0090H.6 A   
P17 . . . . . . . . . . . . . . . .  B ADDR   0090H.7 A   
P1M0. . . . . . . . . . . . . . . .  D ADDR   0092H   A   
P1M1. . . . . . . . . . . . . . . .  D ADDR   0091H   A   
P2. . . . . . . . . . . . . . . . .  D ADDR   00A0H   A   
P20 . . . . . . . . . . . . . . . .  B ADDR   00A0H.0 A   
P21 . . . . . . . . . . . . . . . .  B ADDR   00A0H.1 A   
P22 . . . . . . . . . . . . . . . .  B ADDR   00A0H.2 A   
P23 . . . . . . . . . . . . . . . .  B ADDR   00A0H.3 A   
P24 . . . . . . . . . . . . . . . .  B ADDR   00A0H.4 A   
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE    16

P25 . . . . . . . . . . . . . . . .  B ADDR   00A0H.5 A   
P26 . . . . . . . . . . . . . . . .  B ADDR   00A0H.6 A   
P27 . . . . . . . . . . . . . . . .  B ADDR   00A0H.7 A   
P2M0. . . . . . . . . . . . . . . .  D ADDR   0096H   A   
P2M1. . . . . . . . . . . . . . . .  D ADDR   0095H   A   
P3. . . . . . . . . . . . . . . . .  D ADDR   00B0H   A   
P30 . . . . . . . . . . . . . . . .  B ADDR   00B0H.0 A   
P31 . . . . . . . . . . . . . . . .  B ADDR   00B0H.1 A   
P32 . . . . . . . . . . . . . . . .  B ADDR   00B0H.2 A   
P33 . . . . . . . . . . . . . . . .  B ADDR   00B0H.3 A   
P34 . . . . . . . . . . . . . . . .  B ADDR   00B0H.4 A   
P35 . . . . . . . . . . . . . . . .  B ADDR   00B0H.5 A   
P36 . . . . . . . . . . . . . . . .  B ADDR   00B0H.6 A   
P37 . . . . . . . . . . . . . . . .  B ADDR   00B0H.7 A   
P3M0. . . . . . . . . . . . . . . .  D ADDR   00B2H   A   
P3M1. . . . . . . . . . . . . . . .  D ADDR   00B1H   A   
P4. . . . . . . . . . . . . . . . .  D ADDR   00C0H   A   
P40 . . . . . . . . . . . . . . . .  B ADDR   00C0H.0 A   
P41 . . . . . . . . . . . . . . . .  B ADDR   00C0H.1 A   
P42 . . . . . . . . . . . . . . . .  B ADDR   00C0H.2 A   
P43 . . . . . . . . . . . . . . . .  B ADDR   00C0H.3 A   
P44 . . . . . . . . . . . . . . . .  B ADDR   00C0H.4 A   
P45 . . . . . . . . . . . . . . . .  B ADDR   00C0H.5 A   
P46 . . . . . . . . . . . . . . . .  B ADDR   00C0H.6 A   
P47 . . . . . . . . . . . . . . . .  B ADDR   00C0H.7 A   
P4M0. . . . . . . . . . . . . . . .  D ADDR   00B4H   A   
P4M1. . . . . . . . . . . . . . . .  D ADDR   00B3H   A   
P5. . . . . . . . . . . . . . . . .  D ADDR   00C8H   A   
P50 . . . . . . . . . . . . . . . .  B ADDR   00C8H.0 A   
P51 . . . . . . . . . . . . . . . .  B ADDR   00C8H.1 A   
P52 . . . . . . . . . . . . . . . .  B ADDR   00C8H.2 A   
P53 . . . . . . . . . . . . . . . .  B ADDR   00C8H.3 A   
P54 . . . . . . . . . . . . . . . .  B ADDR   00C8H.4 A   
P5M0. . . . . . . . . . . . . . . .  D ADDR   00CAH   A   
P5M1. . . . . . . . . . . . . . . .  D ADDR   00C9H   A   
P6. . . . . . . . . . . . . . . . .  D ADDR   00E8H   A   
P6M0. . . . . . . . . . . . . . . .  D ADDR   00CCH   A   
P6M1. . . . . . . . . . . . . . . .  D ADDR   00CBH   A   
P7. . . . . . . . . . . . . . . . .  D ADDR   00F8H   A   
P7M0. . . . . . . . . . . . . . . .  D ADDR   00E2H   A   
P7M1. . . . . . . . . . . . . . . .  D ADDR   00E1H   A   
PADC. . . . . . . . . . . . . . . .  B ADDR   00B8H.5 A   
PCON. . . . . . . . . . . . . . . .  D ADDR   0087H   A   
PLVD. . . . . . . . . . . . . . . .  B ADDR   00B8H.6 A   
PPCA. . . . . . . . . . . . . . . .  B ADDR   00B8H.7 A   
PS. . . . . . . . . . . . . . . . .  B ADDR   00B8H.4 A   
PSW . . . . . . . . . . . . . . . .  D ADDR   00D0H   A   
PT0 . . . . . . . . . . . . . . . .  B ADDR   00B8H.1 A   
PT1 . . . . . . . . . . . . . . . .  B ADDR   00B8H.3 A   
PX0 . . . . . . . . . . . . . . . .  B ADDR   00B8H.0 A   
PX1 . . . . . . . . . . . . . . . .  B ADDR   00B8H.2 A   
P_SW1 . . . . . . . . . . . . . . .  D ADDR   00A2H   A   
P_SW2 . . . . . . . . . . . . . . .  D ADDR   00BAH   A   
RB8 . . . . . . . . . . . . . . . .  B ADDR   0098H.2 A   
REN . . . . . . . . . . . . . . . .  B ADDR   0098H.4 A   
RI. . . . . . . . . . . . . . . . .  B ADDR   0098H.0 A   
RS0 . . . . . . . . . . . . . . . .  B ADDR   00D0H.3 A   
RS1 . . . . . . . . . . . . . . . .  B ADDR   00D0H.4 A   
RSTCFG. . . . . . . . . . . . . . .  D ADDR   00FFH   A   
R_SP?242. . . . . . . . . . . . . .  D ADDR   0000H   R   SEG=?DT?_OS_TESK_STACK_INIT?TASK_SWITCH
S2BUF . . . . . . . . . . . . . . .  D ADDR   009BH   A   
S2CON . . . . . . . . . . . . . . .  D ADDR   009AH   A   
S3BUF . . . . . . . . . . . . . . .  D ADDR   00ADH   A   
S3CON . . . . . . . . . . . . . . .  D ADDR   00ACH   A   
S4BUF . . . . . . . . . . . . . . .  D ADDR   0085H   A   
S4CON . . . . . . . . . . . . . . .  D ADDR   0084H   A   
A51 MACRO ASSEMBLER  TASK_SWITCH                                                          10/12/2020 21:22:03 PAGE    17

SADDR . . . . . . . . . . . . . . .  D ADDR   00A9H   A   
SADEN . . . . . . . . . . . . . . .  D ADDR   00B9H   A   
SBUF. . . . . . . . . . . . . . . .  D ADDR   0099H   A   
SCON. . . . . . . . . . . . . . . .  D ADDR   0098H   A   
SM0 . . . . . . . . . . . . . . . .  B ADDR   0098H.7 A   
SM1 . . . . . . . . . . . . . . . .  B ADDR   0098H.6 A   
SM2 . . . . . . . . . . . . . . . .  B ADDR   0098H.5 A   
SP. . . . . . . . . . . . . . . . .  D ADDR   0081H   A   
SPCTL . . . . . . . . . . . . . . .  D ADDR   00CEH   A   
SPDAT . . . . . . . . . . . . . . .  D ADDR   00CFH   A   
SPSTAT. . . . . . . . . . . . . . .  D ADDR   00CDH   A   
T2H . . . . . . . . . . . . . . . .  D ADDR   00D6H   A   
T2L . . . . . . . . . . . . . . . .  D ADDR   00D7H   A   
T3H . . . . . . . . . . . . . . . .  D ADDR   00D4H   A   
T3L . . . . . . . . . . . . . . . .  D ADDR   00D5H   A   
T4H . . . . . . . . . . . . . . . .  D ADDR   00D2H   A   
T4L . . . . . . . . . . . . . . . .  D ADDR   00D3H   A   
T4T3M . . . . . . . . . . . . . . .  D ADDR   00D1H   A   
TA. . . . . . . . . . . . . . . . .  D ADDR   00AEH   A   
TASK_SWITCH . . . . . . . . . . . .  N NUMB   -----       
TB8 . . . . . . . . . . . . . . . .  B ADDR   0098H.3 A   
TCON. . . . . . . . . . . . . . . .  D ADDR   0088H   A   
TF0 . . . . . . . . . . . . . . . .  B ADDR   0088H.5 A   
TF1 . . . . . . . . . . . . . . . .  B ADDR   0088H.7 A   
TH0 . . . . . . . . . . . . . . . .  D ADDR   008CH   A   
TH1 . . . . . . . . . . . . . . . .  D ADDR   008DH   A   
TI. . . . . . . . . . . . . . . . .  B ADDR   0098H.1 A   
TIMER0_ISR. . . . . . . . . . . . .  C ADDR   0000H   R   SEG=?PR?TIMER0_ISR?TASK_SWITCH
TISKS?343 . . . . . . . . . . . . .  D ADDR   0000H   R   SEG=?DT?_OS_DELAY?TASK_SWITCH
TL0 . . . . . . . . . . . . . . . .  D ADDR   008AH   A   
TL1 . . . . . . . . . . . . . . . .  D ADDR   008BH   A   
TMOD. . . . . . . . . . . . . . . .  D ADDR   0089H   A   
TR0 . . . . . . . . . . . . . . . .  B ADDR   0088H.4 A   
TR1 . . . . . . . . . . . . . . . .  B ADDR   0088H.6 A   
USBADR. . . . . . . . . . . . . . .  D ADDR   00FCH   A   
USBCLK. . . . . . . . . . . . . . .  D ADDR   00DCH   A   
USBCON. . . . . . . . . . . . . . .  D ADDR   00F4H   A   
USBDAT. . . . . . . . . . . . . . .  D ADDR   00ECH   A   
WDT_CONTR . . . . . . . . . . . . .  D ADDR   00C1H   A   
WKTCH . . . . . . . . . . . . . . .  D ADDR   00ABH   A   
WKTCL . . . . . . . . . . . . . . .  D ADDR   00AAH   A   
_OS_CPU_SR_RESTORE. . . . . . . . .  C ADDR   0000H   R   SEG=?PR?_OS_CPU_SR_RESTORE?TASK_SWITCH
_OS_DELAY . . . . . . . . . . . . .  C ADDR   0000H   R   SEG=?PR?_OS_DELAY?TASK_SWITCH
_OS_TESK_STACK_INIT . . . . . . . .  C ADDR   0000H   R   SEG=?PR?_OS_TESK_STACK_INIT?TASK_SWITCH


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
